{"timestamp":"2025-11-03T12:39:48.468258","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-11-03T12:39:48.469054","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/dag_reddit_to_dwh.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-11-03T12:39:48.554754Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.555548Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.556015Z","level":"info","event":"Current task name:migrate_dim_reddit_user","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.556434Z","level":"info","event":"Dag name:reddit_staging_to_dwh_migration","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.556760Z","level":"info","event":"--- DÉBUT : Tâche 8a - Migration Dim_Reddit_User ---","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.629979Z","level":"info","event":"   -> (E) Lecture des auteurs 'Processed' depuis Staging_Posts...","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.649305Z","level":"info","event":"   -> 50 auteurs uniques (enrichis) trouvés.","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.707804Z","level":"info","event":"   -> (L) Lecture des utilisateurs existants dans Dim_Reddit_User...","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.714758Z","level":"info","event":"   -> 0 utilisateurs déjà présents dans le DWH.","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.715341Z","level":"info","event":"   -> Lancement de l'UPSERT pour 50 auteurs...","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.715716Z","level":"info","event":"   -> (T/L) INSERT Utilisateur : 12ma89","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.716076Z","level":"info","event":"   -> ❌ ERREUR (Dim_Reddit_User) : 'AccountCreationDate'","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.717597","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"KeyError","exc_value":"'AccountCreationDate'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":251,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/dag_reddit_to_dwh.py","lineno":54,"name":"task_migrate_dim_user"},{"filename":"/opt/airflow/scripts/reddit_dwh_loader.py","lineno":109,"name":"upsert_dim_user"}]}]}
{"timestamp":"2025-11-03T12:39:48.719371Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.724199Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.724689Z","level":"info","event":"Task:<Task(_PythonDecoratedOperator): migrate_dim_reddit_user>","chan":"stdout","logger":"task"}
{"timestamp":"2025-11-03T12:39:48.725117Z","level":"info","event":"Failure caused by 'AccountCreationDate'","chan":"stdout","logger":"task"}
